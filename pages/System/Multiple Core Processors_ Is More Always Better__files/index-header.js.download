var indexRootNamespaceRename=indexRootNamespaceRename||"indexapi";"string"!=typeof indexRootNamespaceRename&&(indexRootNamespaceRename="indexapi"),function(){"use strict";window[indexRootNamespaceRename]=window[indexRootNamespaceRename]||{};var e=function(){function e(e){var t=l[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}function t(t){return p.lastIndex=0,p.test(t)?t.replace(p,e):t}function n(e,t,n,i,o,r,d,a,u,s,f){var c=function(){return t},g=function(){return n},p=function(){return i},l=function(){return o},R=function(){return r},m=function(){return d},v=function(){return e},y=function(){return a},h=function(){return u},x=function(){return s},I=function(){return f},E=function(t,n){var i=[];return o?1===b?i.push(e.getSlotID()+s):2===b?(i.push(e.getSlotID()+s),i.push(e.getSlotID()+"_"+o)):i.push(e.getSlotID()+"_"+o):i.push(e.getSlotID()+s),i};return{getTargetValue:E,getAdm:c,getBrandID:g,getBrandName:p,getDealID:l,getDealName:R,getDSPID:m,getImpression:v,getInternalDealID:y,getPrice:h,getPriceLevel:x,getSeatID:I}}function i(e,t,n,i){var o=!1;return"string"!=typeof e&&(s.debug("ERROR: Slot ID is not a string."),o=!0),"undefined"!=typeof n&&("number"!=typeof n||n<0)&&(s.debug("ERROR: Bid Floor is not a valid number."),o=!0),"undefined"==typeof i||"string"==typeof i&&3===i.length||(s.debug("ERROR: Bid Floor Currency is not a valid ISO currency string."),o=!0),"undefined"!=typeof t&&("number"!=typeof t||t%1!==0||t<0)&&(s.debug("ERROR: Site ID is not a valid number."),o=!0),!o}function o(e,t,n,i,o,r,d,a){e=e.toString();var u={slotID:!0,width:!0,height:!0,bidFloor:!0,bidFloorCurrency:!0,siteID:!0},f=function(){return e},c=function(){return n},g=function(){return t},p=function(){for(var e in u)if(!u[e])return!1;return!0},l=function(){if(p()){var t={id:e,banner:{w:i,h:o},ext:{sid:n}};return"number"==typeof r&&(t.bidfloor=r),"string"==typeof d&&(t.bidfloorcur=d),"number"==typeof a&&(t.ext.siteID=a),t}},R=function(t,n){var i=!1;return("number"!=typeof n||n<0)&&(s.debug("ERROR: Bid Floor for Request "+e+" is not a valid number."),u.bidFloor=!1,i=!0),"string"==typeof t&&3===t.length||(s.debug("ERROR: Bid Floor Currency for Request "+e+" is not a valid ISO currency string."),u.bidFloorCurrency=!1,i=!0),i?(s.debug("DEBUG: Impression "+e+" will not be added to the Request."),!1):(d=t,r=n,u.bidFloor=!0,u.bidFloorCurrency=!0,!0)};return{getImpressionID:f,getSlotID:c,getRequest:g,setBidFloor:R,getObject:l}}function r(e,t,n,i,o){var r=function(){return t},d=function(){return e},a=function(){return n},u=function(){return i},s=function(){var e=function(e){for(var n=[],i=!1,o=0;o<t.length;o++){var r=t[o],d=r.getTargetValue();("undefined"==typeof e||"function"==typeof e&&e(r))&&(d instanceof Array&&(i=!0),n.push(d))}return i?[].concat.apply([],n):n},n=function(){return e()},i=function(){return e(function(e){return!e.getDealID()})},o=function(){return e(function(e){return e.getDealID()})};return{getAll:n,getOpenMarket:i,getPrivateMarket:o}};return{getBids:r,getRequest:d,getStatus:a,getX3:u,getTargets:s}}function d(e,t){e=e.toString();var n,d,c=0,p=!1,l="https:"===window.location.protocol?"https://as-sec.casalemedia.com":"http://as.casalemedia.com",b=!1;"true"===P("indexapi_sandbox",window.top.location.href)&&(l="https:"===window.location.protocol?"https://sandbox.ht.indexexchange.com":"http://sandbox.ht.indexexchange.com");var y={hostname:!0};top===self?(n=location.href,d=1):(n=document.referrer,d=0);var h;E[e]=!1,I[e]={};var x=[],w=function(){var t={};t.id=e,t.imp=[],t.site={page:n},"string"==typeof document.referrer&&(t.site.ref=document.referrer);for(var i=0;i<x.length;i++){var o=x[i].getObject();"undefined"!=typeof o&&(o.banner&&(o.banner.topframe=d),t.imp.push(o))}return t},O=function(){for(var e in y)if(!y[e])return!1;return!0},q=function(t,n,r,d,a,u){var f=!1;if(i(t,u,d,a)||(f=!0),("number"!=typeof n||n%1!==0||n<1)&&(s.debug("ERROR: Width for Request "+e+" is not a valid number."),f=!0),("number"!=typeof r||r%1!==0||r<1)&&(s.debug("ERROR: Height for Request "+e+" is not a valid number."),f=!0),!f){var g=o(c,this,t,n,r,d,a,u);return c++,x.push(g),s.debug("DEBUG: Impression successfully added."),g}},k=function(e){if(!(e instanceof Array))return s.debug("DEBUG: Slots object is not an array. No impressions added."),!1;for(var t=0;t<e.length;t++){var n=e[t];q(n.id,n.width,n.height,n.bidfloor,n.bidfloorcur,n.siteID)}return!0},B=function(){return e},S=function(){return x},j=function(){return v[e]},M=function(n){if(!O())return s.debug("ERROR: Request "+e+" will not be sent, invalid hostname specified."),!1;var i=h||R;i>0&&(D[e]=window.setTimeout(function(){try{v[e]=r(m[e],void 0,3),E[e]=!0,s.debug("DEBUG: Request "+e+" timed out"),"function"==typeof I[e].request?I[e].request(v[e]):"function"==typeof f&&f(v[e])}catch(e){s.debug("ERROR: Error in calling timeout callback: "+e.toString())}},i));var o=w();if(l.match(/^https?:\/\//i))var d=l;else var d=location.protocol+"//"+l;var c="&fn="+encodeURIComponent(indexRootNamespaceRename+".jsonpResponse");for(d+="/cygnus?v="+a+"&s="+t+c,b&&(d+="&x3=1"),/^https?:\/\/as(?:-sec)?\.casalemedia\.com/i.test(d)||(d+="&C=1");(d+"&r="+encodeURIComponent(g(o))).length>u;)o.imp.pop();var p=encodeURIComponent(g(o));d+="&r="+p;var y=document.createElement("script");y.setAttribute("async",n),y.setAttribute("src",d),y.setAttribute("type","text/javascript");var x=document.getElementsByTagName("script")[0];return x.parentNode&&x.parentNode.insertBefore(y,x),!0},T=function(t){var n=!1;return p?(s.debug("ERROR: Request "+e+" has already been sent, will not send request."),n):"function"!=typeof f&&"function"!=typeof I[e].request&&"function"!=typeof I[e].success?(s.debug("ERROR: Request "+e+" is missing a callback, will not send request."),n):(n=M(t),n&&(p=!0,s.debug("DEBUG: Request "+e+" successfully sent to "+l+".")),n)},A=function(){return s.debug("DEBUG: Sending request "+e),T(!1)},C=function(){return s.debug("DEBUG: Sending request "+e+" asynchronously"),T(!0)},N=function(t){return"function"!=typeof t?(s.debug("ERROR: Request callback for Request "+e+" is not a function."),!1):(I[e].request=t,!0)},U=function(t){return"string"!=typeof t?(s.debug("ERROR: Page Override for Request "+e+" is not a string."),!1):(n=t,!0)},z=function(t){return"number"!=typeof t||t%1!==0||t<0?(s.debug("ERROR: Timeout for Request "+e+" is not a number."),!1):(h=t,!0)},G=function(e){return"string"==typeof e&&/^(?:[a-z0-9][a-z0-9-]*\.)+casalemedia\.com$/i.test(e)?(l=e,y.hostname=!0,!0):(s.debug("ERROR: Hostname is not valid, will not send to this hostname."),y.hostname=!1,!1)},F=function(e){return"boolean"!=typeof e?(s.debug("ERROR: Request X3 parameter is not valid."),!1):(b=e,!0)};return{addImpression:q,getID:B,getImpressions:S,buildImpressions:k,getResponse:j,sendRequest:A,sendRequestAsync:C,setCallback:N,setPageOverride:U,setRequestTimeout:z,setHostname:G,requestX3:F}}var a="8.8",u=8e3,s=function(){var e=0,t=1,n=e,i=function(e){n==t&&console.log("[ASL] "+e)},o=function(i){n=i?t:e};return{enabled:o,debug:i}}();if("undefined"!=typeof document.documentMode&&typeof document.documentMode<9)return s.enabled(!0),void s.debug("ERROR: ASL v"+a+" does not support IE versions running below 9 standards mode.");var f,c,g=function(e){var n='{"id":"'+e.id+'","site":{"page":"'+t(e.site.page)+(Mntl&&Mntl.RTB&&Mntl.RTB.indexFirstPartyData ? '#'+Mntl.RTB.indexFirstPartyData : '')+'"';"string"==typeof e.site.ref&&(n+=',"ref":"'+t(e.site.ref)+'"'),n+='},"imp":[';for(var i=0;i<e.imp.length;i++){var o=e.imp[i],r=[];if(n+='{"id":"'+o.id+'"',"undefined"!=typeof o.banner){var d=o.banner;n+=', "banner":{"w":'+d.w+',"h":'+d.h+',"topframe":'+String(d.topframe)+"}"}"number"==typeof o.bidfloor&&(n+=',"bidfloor":'+o.bidfloor,"string"==typeof o.bidfloorcur&&(n+=',"bidfloorcur":"'+t(o.bidfloorcur)+'"')),"string"!=typeof o.ext.sid||o.ext.sid.match(/^\s*$/)||r.push('"sid":"'+t(o.ext.sid)+'"'),"number"==typeof o.ext.siteID&&r.push('"siteID":'+o.ext.siteID),r.length>0&&(n+=',"ext":{'+r.join()+"}"),n+=i+1==e.imp.length?"}":"},"}return n+="]}"},p=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},R=0,b=0,m={},v={},y={},h="IOM",x="IPM",I={},E={},D={},w=function(e){if("number"!=typeof e||e%1!==0||e<0)return void s.debug("ERROR: Invalid siteID when creating Request");c="undefined"==typeof c?Math.floor(256*Math.random()):(c+1)%256;var t=d(String((new Date).getTime()%2592e3*256+c+256),e);return m[t.getID()]=t,t},O=function(e){try{if(!e)return void s.debug("ERROR: Received an invalid JSON object in response.");if("object"!=typeof e||"undefined"==typeof e.id)return void s.debug("ERROR: Received an invalid JSON object in response.");var t=m[e.id];if(s.debug("DEBUG: Received JSON object in response for Request "+e.id),"undefined"==typeof t)return void s.debug("ERROR: Could not find Request with id: "+e.id+".");var i,o=t.getImpressions(),d=[];if(E[t.getID()])return;if(window.clearTimeout(D[t.getID()]),"undefined"!=typeof e.ext&&e.ext.x3 instanceof Array&&(i=e.ext.x3),"undefined"==typeof e.seatbid){try{v[t.getID()]=r(t,[],1,i),s.debug("DEBUG: Pass response parsed."),"function"==typeof I[t.getID()].request?I[t.getID()].request(v[t.getID()]):"function"==typeof f&&f(v[t.getID()])}catch(e){s.debug("ERROR: Error in calling pass callback: "+e.toString())}return}for(var a=0;a<e.seatbid.length;a++)for(var u=0;u<e.seatbid[a].bid.length;u++){for(var c,g=e.seatbid[a].bid[u],p=0;p<o.length;p++)if(o[p].getImpressionID()===g.impid){c=o[p];break}if("undefined"!=typeof c)if("object"==typeof g.ext){var l=void 0,R=void 0,b=void 0,h=void 0,x=void 0,w=void 0,O=void 0,q=void 0,k=void 0,B=void 0,S=void 0,j=void 0,M=void 0,T=void 0,A=void 0;if("string"==typeof g.adm&&"undefined"==typeof g.ext.vasturl&&"undefined"==typeof g.ext.errorurl?(x=g.adm,l=void 0,R=void 0,h=c,b=void 0):"undefined"!=typeof g.adm&&s.debug("ERROR: Bid contained no valid adm."),"number"==typeof g.ext.advbrandid?w=g.ext.advbrandid:"undefined"!=typeof g.ext.advbrandid&&s.debug("ERROR: Bid contained no valid advertiser ID."),"string"==typeof g.ext.advbrand?O=g.ext.advbrand:"undefined"!=typeof g.ext.advbrand&&s.debug("ERROR: Bid contained no valid advertiser brand name."),"number"==typeof g.ext.deal?q=g.ext.deal:"undefined"!=typeof g.ext.deal&&s.debug("ERROR: Bid contained no valid internal deal ID."),"string"==typeof g.ext.dealname?k=g.ext.dealname:"undefined"!=typeof g.ext.dealname&&s.debug("ERROR: Bid contained no valid deal name."),"number"==typeof g.ext.dspid?B=g.ext.dspid:"undefined"!=typeof g.ext.dspid&&s.debug("ERROR: Bid contained no valid DSP ID."),"string"==typeof g.dealid||"string"==typeof g.ext.dealid?S=g.dealid||g.ext.dealid:"undefined"!=typeof g.dealid?s.debug("ERROR: Bid contained no valid deal ID."):"undefined"!=typeof g.ext.dealid&&s.debug("ERROR: Bid contained no valid deal ID."),"number"==typeof g.price?j=g.price:"undefined"!=typeof g.price&&s.debug("ERROR: Bid contained no valid price."),"string"==typeof g.ext.pricelevel)M=g.ext.pricelevel;else if("undefined"!=typeof g.ext.pricelevel){s.debug("ERROR: Price Level in the Bid was not a string.");continue}"string"==typeof e.seatbid[a].seat?T=e.seatbid[a].seat:"undefined"!=typeof e.seatbid[a].seat&&s.debug("ERROR: Bid contained no valid seat."),"string"==typeof g.ext.vasturl?(l=g.ext.vasturl,b=c,h=void 0,x=void 0):"undefined"!=typeof g.ext.vasturl&&s.debug("ERROR: Bid contained no valid VAST creative url."),"string"==typeof g.ext.errorurl?R=g.ext.errorurl:"undefined"!=typeof g.ext.errorurl&&s.debug("ERROR: Bid contained no valid VAST error url."),"number"==typeof g.ext.ttl?A=g.ext.ttl:"undefined"!=typeof g.ext.ttl&&s.debug("ERROR: Bid contained invalid ttl value.");for(var C=n(h,x,w,O,S,k,B,q,j,M,T),N=C.getTargetValue(),U=0;U<N.length;U++){var P=N[U];y[P]=C}d.push(C)}else s.debug("ERROR: Bid extension of bid "+g.impid+" is not an object.");else s.debug("ERROR: Could not find Impression with id "+g.impid+".")}}catch(e){if(s.debug("ERROR: Error parsing Response: "+e.toString()),"undefined"==typeof t)return void r(void 0,void 0,2,i);try{v[t.getID()]=r(t,void 0,2,i),"function"==typeof I[t.getID()].request?I[t.getID()].request(v[t.getID()]):"function"==typeof f&&f(v[t.getID()])}catch(e){s.debug("ERROR: Error in calling error callback: "+e.toString())}return}if("undefined"!=typeof t)if(d.length>0)try{v[t.getID()]=r(t,d,0,i),s.debug("DEBUG: Successful response parsed."),"function"==typeof I[t.getID()].request?I[t.getID()].request(v[t.getID()]):"function"==typeof f&&f(v[t.getID()])}catch(e){s.debug("ERROR: Error in calling success callback: "+e.toString())}else try{v[t.getID()]=r(t,d,1,i),s.debug("DEBUG: Pass response parsed."),"function"==typeof I[t.getID()].request?I[t.getID()].request(v[t.getID()]):"function"==typeof f&&f(v[t.getID()])}catch(e){s.debug("ERROR: Error in calling pass callback: "+e.toString())}},q=function(e,t){var n=!1;return"string"!=typeof e&&(s.debug("ERROR: Target ID in mapping is not a string."),n=!0),"object"!=typeof t&&(s.debug("ERROR: Bid in mapping is not an object."),n=!0),"undefined"==typeof t||"function"==typeof t.getAdm&&"undefined"!=typeof t.getAdm()||(s.debug("ERROR: Bid object in mapping does not contain an adm."),n=!0),!n&&(y[e]=t,!0)},k=function(e,t){if("string"!=typeof e)return s.debug("ERROR: Target ID to render is not a string."),!1;if("undefined"==typeof y[e])return s.debug("ERROR: Could not find "+e+" in the bid mappings."),!1;var n=y[e];return"undefined"!=typeof n.getImpression()&&("undefined"==typeof t?(s.debug("ERROR: Can't render creative: Document object is undefined"),!1):t===window.top.document?(s.debug("ERROR: Can't render creative: Not in an iframe"),!1):(t.write(n.getAdm()),!0))};window.headertag_render=function(e,t,n){s.debug("DEBUG: Sent targets: "+t+", with selector: "+n);var i,o,r=n,d=t.split(",");for(i=0;i<d.length;i++)if(o=d[i].split("_"),o[0]==r)return void k(d[i],e)};var B=function(e){return"boolean"!=typeof e?void s.debug("ERROR: Invalid debug mode parameter."):void s.enabled(e)},S=function(e){return"function"!=typeof e?(s.debug("ERROR: Request callback is not a function"),!1):(f=e,!0)},j=function(e){return"number"!=typeof e||e%1!==0||e<0?(s.debug("ERROR: Timeout is not a number."),!1):(R=e,!0)},M=function(){return b},T=function(e){return"number"!=typeof e?(s.debug("ERROR: Target Mode is not a number"),!1):e<0||e>2?(s.debug("ERROR: Target Mode may only be set to 0, 1, or 2"),!1):(b=e,!0)},A=function(){return h},C=function(e){return"string"!=typeof e?(s.debug("ERROR: Open Market Key is not a string"),!1):(h=e,!0)},N=function(){return x},U=function(e){return"string"!=typeof e?(s.debug("ERROR: Private Market Key is not a string"),!1):(x=e,!0)},P=function(e,t){var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)","i"),i=n.exec(t);if(i&&i[2])return decodeURIComponent(i[2].replace(/\+/g," "))},z=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e};return{createRequest:w,jsonpResponse:O,registerTargetMapping:q,render:k,setDebugMode:B,setRequestCallback:S,setRequestTimeout:j,getOpenMarketKey:A,setOpenMarketKey:C,getPrivateMarketKey:N,setPrivateMarketKey:U,getTargetMode:M,setTargetMode:T,isMobile:z}}();window[indexRootNamespaceRename]=e}();var indexRootNamespaceRename=indexRootNamespaceRename||"indexapi";"string"!=typeof indexRootNamespaceRename&&(indexRootNamespaceRename="indexapi"),function(){"use strict";window[indexRootNamespaceRename]=window[indexRootNamespaceRename]||{};var e=function(){function e(e){var t=l[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}function t(t){return p.lastIndex=0,p.test(t)?t.replace(p,e):t}function n(e,t,n,i,o,r,d,a,u,s,f){var c=function(){return t},g=function(){return n},p=function(){return i},l=function(){return o},R=function(){return r},m=function(){return d},v=function(){return e},y=function(){return a},h=function(){return u},x=function(){return s},I=function(){return f},E=function(t,n){var i=[];return o?1===b?i.push(e.getSlotID()+s):2===b?(i.push(e.getSlotID()+s),i.push(e.getSlotID()+"_"+o)):i.push(e.getSlotID()+"_"+o):i.push(e.getSlotID()+s),i};return{getTargetValue:E,getAdm:c,getBrandID:g,getBrandName:p,getDealID:l,getDealName:R,getDSPID:m,getImpression:v,getInternalDealID:y,getPrice:h,getPriceLevel:x,getSeatID:I}}function i(e,t,n,i){var o=!1;return"string"!=typeof e&&(s.debug("ERROR: Slot ID is not a string."),o=!0),"undefined"!=typeof n&&("number"!=typeof n||n<0)&&(s.debug("ERROR: Bid Floor is not a valid number."),o=!0),"undefined"==typeof i||"string"==typeof i&&3===i.length||(s.debug("ERROR: Bid Floor Currency is not a valid ISO currency string."),o=!0),"undefined"!=typeof t&&("number"!=typeof t||t%1!==0||t<0)&&(s.debug("ERROR: Site ID is not a valid number."),o=!0),!o}function o(e,t,n,i,o,r,d,a){e=e.toString();var u={slotID:!0,width:!0,height:!0,bidFloor:!0,bidFloorCurrency:!0,siteID:!0},f=function(){return e},c=function(){return n},g=function(){return t},p=function(){for(var e in u)if(!u[e])return!1;return!0},l=function(){if(p()){var t={id:e,banner:{w:i,h:o},ext:{sid:n}};return"number"==typeof r&&(t.bidfloor=r),"string"==typeof d&&(t.bidfloorcur=d),"number"==typeof a&&(t.ext.siteID=a),t}},R=function(t,n){var i=!1;return("number"!=typeof n||n<0)&&(s.debug("ERROR: Bid Floor for Request "+e+" is not a valid number."),u.bidFloor=!1,i=!0),"string"==typeof t&&3===t.length||(s.debug("ERROR: Bid Floor Currency for Request "+e+" is not a valid ISO currency string."),u.bidFloorCurrency=!1,i=!0),i?(s.debug("DEBUG: Impression "+e+" will not be added to the Request."),!1):(d=t,r=n,u.bidFloor=!0,u.bidFloorCurrency=!0,!0)};return{getImpressionID:f,getSlotID:c,getRequest:g,setBidFloor:R,getObject:l}}function r(e,t,n,i,o){var r=function(){return t},d=function(){return e},a=function(){return n},u=function(){return i},s=function(){var e=function(e){for(var n=[],i=!1,o=0;o<t.length;o++){var r=t[o],d=r.getTargetValue();("undefined"==typeof e||"function"==typeof e&&e(r))&&(d instanceof Array&&(i=!0),n.push(d))}return i?[].concat.apply([],n):n},n=function(){return e()},i=function(){return e(function(e){return!e.getDealID()})},o=function(){return e(function(e){return e.getDealID()})};return{getAll:n,getOpenMarket:i,getPrivateMarket:o}};return{getBids:r,getRequest:d,getStatus:a,getX3:u,getTargets:s}}function d(e,t){e=e.toString();var n,d,c=0,p=!1,l="https:"===window.location.protocol?"https://as-sec.casalemedia.com":"http://as.casalemedia.com",b=!1;"true"===P("indexapi_sandbox",window.top.location.href)&&(l="https:"===window.location.protocol?"https://sandbox.ht.indexexchange.com":"http://sandbox.ht.indexexchange.com");var y={hostname:!0};top===self?(n=location.href,d=1):(n=document.referrer,d=0);var h;E[e]=!1,I[e]={};var x=[],w=function(){var t={};t.id=e,t.imp=[],t.site={page:n},"string"==typeof document.referrer&&(t.site.ref=document.referrer);for(var i=0;i<x.length;i++){var o=x[i].getObject();"undefined"!=typeof o&&(o.banner&&(o.banner.topframe=d),t.imp.push(o))}return t},O=function(){for(var e in y)if(!y[e])return!1;return!0},q=function(t,n,r,d,a,u){var f=!1;if(i(t,u,d,a)||(f=!0),("number"!=typeof n||n%1!==0||n<1)&&(s.debug("ERROR: Width for Request "+e+" is not a valid number."),f=!0),("number"!=typeof r||r%1!==0||r<1)&&(s.debug("ERROR: Height for Request "+e+" is not a valid number."),f=!0),!f){var g=o(c,this,t,n,r,d,a,u);return c++,x.push(g),s.debug("DEBUG: Impression successfully added."),g}},k=function(e){if(!(e instanceof Array))return s.debug("DEBUG: Slots object is not an array. No impressions added."),!1;for(var t=0;t<e.length;t++){var n=e[t];q(n.id,n.width,n.height,n.bidfloor,n.bidfloorcur,n.siteID)}return!0},B=function(){return e},S=function(){return x},j=function(){return v[e]},M=function(n){if(!O())return s.debug("ERROR: Request "+e+" will not be sent, invalid hostname specified."),!1;var i=h||R;i>0&&(D[e]=window.setTimeout(function(){try{v[e]=r(m[e],void 0,3),E[e]=!0,s.debug("DEBUG: Request "+e+" timed out"),"function"==typeof I[e].request?I[e].request(v[e]):"function"==typeof f&&f(v[e])}catch(e){s.debug("ERROR: Error in calling timeout callback: "+e.toString())}},i));var o=w();if(l.match(/^https?:\/\//i))var d=l;else var d=location.protocol+"//"+l;var c="&fn="+encodeURIComponent(indexRootNamespaceRename+".jsonpResponse");for(d+="/cygnus?v="+a+"&s="+t+c,b&&(d+="&x3=1"),/^https?:\/\/as(?:-sec)?\.casalemedia\.com/i.test(d)||(d+="&C=1");(d+"&r="+encodeURIComponent(g(o))).length>u;)o.imp.pop();var p=encodeURIComponent(g(o));d+="&r="+p;var y=document.createElement("script");y.setAttribute("async",n),y.setAttribute("src",d),y.setAttribute("type","text/javascript");var x=document.getElementsByTagName("script")[0];return x.parentNode&&x.parentNode.insertBefore(y,x),!0},T=function(t){var n=!1;return p?(s.debug("ERROR: Request "+e+" has already been sent, will not send request."),n):"function"!=typeof f&&"function"!=typeof I[e].request&&"function"!=typeof I[e].success?(s.debug("ERROR: Request "+e+" is missing a callback, will not send request."),n):(n=M(t),n&&(p=!0,s.debug("DEBUG: Request "+e+" successfully sent to "+l+".")),n)},A=function(){return s.debug("DEBUG: Sending request "+e),T(!1)},C=function(){return s.debug("DEBUG: Sending request "+e+" asynchronously"),T(!0)},N=function(t){return"function"!=typeof t?(s.debug("ERROR: Request callback for Request "+e+" is not a function."),!1):(I[e].request=t,!0)},U=function(t){return"string"!=typeof t?(s.debug("ERROR: Page Override for Request "+e+" is not a string."),!1):(n=t,!0)},z=function(t){return"number"!=typeof t||t%1!==0||t<0?(s.debug("ERROR: Timeout for Request "+e+" is not a number."),!1):(h=t,!0)},G=function(e){return"string"==typeof e&&/^(?:[a-z0-9][a-z0-9-]*\.)+casalemedia\.com$/i.test(e)?(l=e,y.hostname=!0,!0):(s.debug("ERROR: Hostname is not valid, will not send to this hostname."),y.hostname=!1,!1)},F=function(e){return"boolean"!=typeof e?(s.debug("ERROR: Request X3 parameter is not valid."),!1):(b=e,!0)};return{addImpression:q,getID:B,getImpressions:S,buildImpressions:k,getResponse:j,sendRequest:A,sendRequestAsync:C,setCallback:N,setPageOverride:U,setRequestTimeout:z,setHostname:G,requestX3:F}}var a="8.8",u=8e3,s=function(){var e=0,t=1,n=e,i=function(e){n==t&&console.log("[ASL] "+e)},o=function(i){n=i?t:e};return{enabled:o,debug:i}}();if("undefined"!=typeof document.documentMode&&typeof document.documentMode<9)return s.enabled(!0),void s.debug("ERROR: ASL v"+a+" does not support IE versions running below 9 standards mode.");var f,c,g=function(e){var n='{"id":"'+e.id+'","site":{"page":"'+t(e.site.page)+(Mntl&&Mntl.RTB&&Mntl.RTB.indexFirstPartyData ? '#'+Mntl.RTB.indexFirstPartyData : '')+'"';"string"==typeof e.site.ref&&(n+=',"ref":"'+t(e.site.ref)+'"'),n+='},"imp":[';for(var i=0;i<e.imp.length;i++){var o=e.imp[i],r=[];if(n+='{"id":"'+o.id+'"',"undefined"!=typeof o.banner){var d=o.banner;n+=', "banner":{"w":'+d.w+',"h":'+d.h+',"topframe":'+String(d.topframe)+"}"}"number"==typeof o.bidfloor&&(n+=',"bidfloor":'+o.bidfloor,"string"==typeof o.bidfloorcur&&(n+=',"bidfloorcur":"'+t(o.bidfloorcur)+'"')),"string"!=typeof o.ext.sid||o.ext.sid.match(/^\s*$/)||r.push('"sid":"'+t(o.ext.sid)+'"'),"number"==typeof o.ext.siteID&&r.push('"siteID":'+o.ext.siteID),r.length>0&&(n+=',"ext":{'+r.join()+"}"),n+=i+1==e.imp.length?"}":"},"}return n+="]}"},p=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},R=0,b=0,m={},v={},y={},h="IOM",x="IPM",I={},E={},D={},w=function(e){if("number"!=typeof e||e%1!==0||e<0)return void s.debug("ERROR: Invalid siteID when creating Request");c="undefined"==typeof c?Math.floor(256*Math.random()):(c+1)%256;var t=d(String((new Date).getTime()%2592e3*256+c+256),e);return m[t.getID()]=t,t},O=function(e){try{if(!e)return void s.debug("ERROR: Received an invalid JSON object in response.");if("object"!=typeof e||"undefined"==typeof e.id)return void s.debug("ERROR: Received an invalid JSON object in response.");var t=m[e.id];if(s.debug("DEBUG: Received JSON object in response for Request "+e.id),"undefined"==typeof t)return void s.debug("ERROR: Could not find Request with id: "+e.id+".");var i,o=t.getImpressions(),d=[];if(E[t.getID()])return;if(window.clearTimeout(D[t.getID()]),"undefined"!=typeof e.ext&&e.ext.x3 instanceof Array&&(i=e.ext.x3),"undefined"==typeof e.seatbid){try{v[t.getID()]=r(t,[],1,i),s.debug("DEBUG: Pass response parsed."),"function"==typeof I[t.getID()].request?I[t.getID()].request(v[t.getID()]):"function"==typeof f&&f(v[t.getID()])}catch(e){s.debug("ERROR: Error in calling pass callback: "+e.toString())}return}for(var a=0;a<e.seatbid.length;a++)for(var u=0;u<e.seatbid[a].bid.length;u++){for(var c,g=e.seatbid[a].bid[u],p=0;p<o.length;p++)if(o[p].getImpressionID()===g.impid){c=o[p];break}if("undefined"!=typeof c)if("object"==typeof g.ext){var l=void 0,R=void 0,b=void 0,h=void 0,x=void 0,w=void 0,O=void 0,q=void 0,k=void 0,B=void 0,S=void 0,j=void 0,M=void 0,T=void 0,A=void 0;if("string"==typeof g.adm&&"undefined"==typeof g.ext.vasturl&&"undefined"==typeof g.ext.errorurl?(x=g.adm,l=void 0,R=void 0,h=c,b=void 0):"undefined"!=typeof g.adm&&s.debug("ERROR: Bid contained no valid adm."),"number"==typeof g.ext.advbrandid?w=g.ext.advbrandid:"undefined"!=typeof g.ext.advbrandid&&s.debug("ERROR: Bid contained no valid advertiser ID."),"string"==typeof g.ext.advbrand?O=g.ext.advbrand:"undefined"!=typeof g.ext.advbrand&&s.debug("ERROR: Bid contained no valid advertiser brand name."),"number"==typeof g.ext.deal?q=g.ext.deal:"undefined"!=typeof g.ext.deal&&s.debug("ERROR: Bid contained no valid internal deal ID."),"string"==typeof g.ext.dealname?k=g.ext.dealname:"undefined"!=typeof g.ext.dealname&&s.debug("ERROR: Bid contained no valid deal name."),"number"==typeof g.ext.dspid?B=g.ext.dspid:"undefined"!=typeof g.ext.dspid&&s.debug("ERROR: Bid contained no valid DSP ID."),"string"==typeof g.dealid||"string"==typeof g.ext.dealid?S=g.dealid||g.ext.dealid:"undefined"!=typeof g.dealid?s.debug("ERROR: Bid contained no valid deal ID."):"undefined"!=typeof g.ext.dealid&&s.debug("ERROR: Bid contained no valid deal ID."),"number"==typeof g.price?j=g.price:"undefined"!=typeof g.price&&s.debug("ERROR: Bid contained no valid price."),"string"==typeof g.ext.pricelevel)M=g.ext.pricelevel;else if("undefined"!=typeof g.ext.pricelevel){s.debug("ERROR: Price Level in the Bid was not a string.");continue}"string"==typeof e.seatbid[a].seat?T=e.seatbid[a].seat:"undefined"!=typeof e.seatbid[a].seat&&s.debug("ERROR: Bid contained no valid seat."),"string"==typeof g.ext.vasturl?(l=g.ext.vasturl,b=c,h=void 0,x=void 0):"undefined"!=typeof g.ext.vasturl&&s.debug("ERROR: Bid contained no valid VAST creative url."),"string"==typeof g.ext.errorurl?R=g.ext.errorurl:"undefined"!=typeof g.ext.errorurl&&s.debug("ERROR: Bid contained no valid VAST error url."),"number"==typeof g.ext.ttl?A=g.ext.ttl:"undefined"!=typeof g.ext.ttl&&s.debug("ERROR: Bid contained invalid ttl value.");for(var C=n(h,x,w,O,S,k,B,q,j,M,T),N=C.getTargetValue(),U=0;U<N.length;U++){var P=N[U];y[P]=C}d.push(C)}else s.debug("ERROR: Bid extension of bid "+g.impid+" is not an object.");else s.debug("ERROR: Could not find Impression with id "+g.impid+".")}}catch(e){if(s.debug("ERROR: Error parsing Response: "+e.toString()),"undefined"==typeof t)return void r(void 0,void 0,2,i);try{v[t.getID()]=r(t,void 0,2,i),"function"==typeof I[t.getID()].request?I[t.getID()].request(v[t.getID()]):"function"==typeof f&&f(v[t.getID()])}catch(e){s.debug("ERROR: Error in calling error callback: "+e.toString())}return}if("undefined"!=typeof t)if(d.length>0)try{v[t.getID()]=r(t,d,0,i),s.debug("DEBUG: Successful response parsed."),"function"==typeof I[t.getID()].request?I[t.getID()].request(v[t.getID()]):"function"==typeof f&&f(v[t.getID()])}catch(e){s.debug("ERROR: Error in calling success callback: "+e.toString())}else try{v[t.getID()]=r(t,d,1,i),s.debug("DEBUG: Pass response parsed."),"function"==typeof I[t.getID()].request?I[t.getID()].request(v[t.getID()]):"function"==typeof f&&f(v[t.getID()])}catch(e){s.debug("ERROR: Error in calling pass callback: "+e.toString())}},q=function(e,t){var n=!1;return"string"!=typeof e&&(s.debug("ERROR: Target ID in mapping is not a string."),n=!0),"object"!=typeof t&&(s.debug("ERROR: Bid in mapping is not an object."),n=!0),"undefined"==typeof t||"function"==typeof t.getAdm&&"undefined"!=typeof t.getAdm()||(s.debug("ERROR: Bid object in mapping does not contain an adm."),n=!0),!n&&(y[e]=t,!0)},k=function(e,t){if("string"!=typeof e)return s.debug("ERROR: Target ID to render is not a string."),!1;if("undefined"==typeof y[e])return s.debug("ERROR: Could not find "+e+" in the bid mappings."),!1;var n=y[e];return"undefined"!=typeof n.getImpression()&&("undefined"==typeof t?(s.debug("ERROR: Can't render creative: Document object is undefined"),!1):t===window.top.document?(s.debug("ERROR: Can't render creative: Not in an iframe"),!1):(t.write(n.getAdm()),!0))};window.headertag_render=function(e,t,n){s.debug("DEBUG: Sent targets: "+t+", with selector: "+n);var i,o,r=n,d=t.split(",");for(i=0;i<d.length;i++)if(o=d[i].split("_"),o[0]==r)return void k(d[i],e)};var B=function(e){return"boolean"!=typeof e?void s.debug("ERROR: Invalid debug mode parameter."):void s.enabled(e)},S=function(e){return"function"!=typeof e?(s.debug("ERROR: Request callback is not a function"),!1):(f=e,!0)},j=function(e){return"number"!=typeof e||e%1!==0||e<0?(s.debug("ERROR: Timeout is not a number."),!1):(R=e,!0)},M=function(){return b},T=function(e){return"number"!=typeof e?(s.debug("ERROR: Target Mode is not a number"),!1):e<0||e>2?(s.debug("ERROR: Target Mode may only be set to 0, 1, or 2"),!1):(b=e,!0)},A=function(){return h},C=function(e){return"string"!=typeof e?(s.debug("ERROR: Open Market Key is not a string"),!1):(h=e,!0)},N=function(){return x},U=function(e){return"string"!=typeof e?(s.debug("ERROR: Private Market Key is not a string"),!1):(x=e,!0)},P=function(e,t){var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)","i"),i=n.exec(t);if(i&&i[2])return decodeURIComponent(i[2].replace(/\+/g," "))},z=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e};return{createRequest:w,jsonpResponse:O,registerTargetMapping:q,render:k,setDebugMode:B,setRequestCallback:S,setRequestTimeout:j,getOpenMarketKey:A,setOpenMarketKey:C,getPrivateMarketKey:N,setPrivateMarketKey:U,getTargetMode:M,setTargetMode:T,isMobile:z}}();window[indexRootNamespaceRename]=e}();